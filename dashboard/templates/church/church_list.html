{% extends "app/base_site.html" %}

{% block title %} church {% endblock title %}

{% load static i18n %}

{% block stylesheets %}
    {{ block.super }}

{% endblock stylesheets %}

{% block content %}
    <div class="right_col" role="main">
        <div class="row">
            <div class="col-md-12 col-sm-12 col-xs-12">
                <div class="x_panel">
                    <div class="x_title">
                        <h1 style="text-align: center;"><i class="fa fa-home"></i><b> CHURCH MODULE</b></h1>
                        <ul class="nav navbar-right panel_toolbox">
                            <li><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                            </li>
                        </ul>
                        <div class="clearfix"></div>
                    </div>

                    <div class="x_content quick-link">
                        <span style="color:red"><b>Other Archived Reports:</b></span>
                        <a href="{% url  'expensesarchivessearch' %}"> Main Expenses</a>
                        |<a href="{% url 'general-expensesarchives-search' %}"> General Expenses</a>
                        |<a href="{% url 'offeringsarchivessearch' %}"> Offerings</a>
                    
                        |<a href="{% url 'pledgesarchivessearch' %}"> Pledges</a>
                    
                        |<a href="{% url 'sundryarchivessearch' %}"> Petty Expenses</a>
                        {% if request.user.Role == 'Secretary' or user.Role == 'Admin' or user.Role == 'SuperAdmin' or user.Role == 'Assistant_Admin' %}
                        |<a href="{% url 'allowancearchivessearch' %}"> Allowances</a>
                        |<a href="{% url 'salariespaidarchivessearch' %}"> Salaries</a>
                        |<a href="{% url 'tithesarchivessearch' %}"> Tithes</a>
                        |<a href="{% url 'seeds-archives-search' %}"> Seeds</a>
                        |<a href="{% url 'thanksgivingarchivessearch' %}"> ThanksGiving</a>
                        {% endif %}
                        |<a href="{% url 'BuildingRenovationarchivessearch' %}"> Building</a>
                        <div class="separator"></div>
                    </div>
                    <h2 style="text-align: center;">All Church Details</h2>
                    <div class="separator"></div>
                    <div class="x_content">
                        <div class="" data-example-id="togglable-tabs">

                            <ul class="nav nav-tabs bordered">
                                <li role="presentation" class="active"><a href="{% url 'church_list' %}"><i
                                        class="fa fa-list-ol"></i> church Details</a>
                                </li>
                                {% comment %}
                                {% if request.user.Role == 'SuperAdmin'  %}
                                
                                        <li role="presentation"><a href="{% url 'church_create' %}"><i
                                                class="fa fa-plus-square-o"></i> Add church Details</a>
                                        </li>
                                {% endif %}
                                {% endcomment %}
                            </ul>

                            <div class="tab-content">
                                <div class="tab-pane fade in active" id="tab_school_list">
                                    <div class="x_content">

                                        <table id="church-table"
                                               class="table table-striped table-bordered dt-responsive nowrap"
                                               cellspacing="0" width="100%">
                                            <thead>
                                            <tr>
                                                <th>church Name</th>
                                                <th>Address</th>
                                                <th>Phone</th>
                                                <th>Actions</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                                {% for church in churches %}
                                                    <tr>
                                                        <td>{{ church.church_name }}</td>
                                                        <td>{{ church.address }}</td>
                                                        <td>{{ church.phone }}</td>
                                                        <td>
                                                            <button type="button" class="btn btn-success btn-sm js-view-church" data-url="{% url 'church_view' church.id %}">
                                                                <span class="glyphicon glyphicon-eye-open"></span> View
                                                            </button>

                                                            {% if request.user.Role == 'Secretary' or user.Role == 'Admin' or user.Role == 'SuperAdmin' or user.Role == 'Assistant_Admin' %}
                                                                <div class="mb-4">
                                                                    <a href="{% url 'church_update' church.id %}" class="btn btn-info btn-sm">
                                                                        <span class="fa fa-pencil-square-o"></span> Edit</a>
                                                                </div>
                                                            {% endif %}
                                                            <br>
                                                        </td>
                                                    </tr>
                                                {% empty %}
                                                    <tr>
                                                        <td colspan="9" class="text-center bg-warning">No church</td>
                                                    </tr>
                                                {% endfor %}

                                            </tbody>
                                        </table>

                                    </div>
                                </div>

                                <!-- THE MODAL WE WILL BE USING -->
                                <div class="modal fade" id="church-modal">
                                    <div class="modal-dialog modal-lg">
                                        <div class="modal-content">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

  <script> type="text/javascript">
    $(document).ready(function () {
        $('#church-table').DataTable({
            dom: 'Bfrtip',
            iDisplayLength: 15,
            buttons: [
                'copyHtml5',
                'excelHtml5',
                'csvHtml5',
                'pdfHtml5',
                'print',
                'pageLength'
            ],
            search: true,
            responsive: true
        });
    });
    $(function () {
        var loadForm = function () {
            var btn = $(this);
            $.ajax({
                url: btn.attr("data-url"),
                type: 'get',
                dataType: 'json',
                beforeSend: function () {
                    $("#church-modal").modal("show");
                },
                success: function (data) {
                    $("#church-modal .modal-content").html(data.html_form);
                }
            });
        };
        $("#church-table").on("click", ".js-view-church", loadForm);
        }
        );    
    </script>  

{% endblock content %}

{% block javascripts %}

    {{ block.super }}

{% endblock javascripts %}




